@using System.Globalization
@namespace Finance.Mobile.Components.Charts

<style>
    .category-chart { width:100%; }
    .category-row { display:flex; flex-direction:column; gap:6px; margin-bottom:12px; }
    .cat-info { display:flex; justify-content:space-between; font-size:0.9rem; margin-bottom:4px; }
    .bar-bg { background:rgba(0,0,0,0.04); height:18px; border-radius:10px; overflow:hidden; }
    .bar { height:100%; border-radius:10px 0 0 10px; }
    .no-data { text-align:center; color:rgba(0,0,0,0.45); padding:24px 0; }
</style>

@code {
    [Parameter] public string[] Labels { get; set; } = Array.Empty<string>();
    [Parameter] public double[] Values { get; set; } = Array.Empty<double>();
    [Parameter] public string? EmptyMessage { get; set; } = "Sem dados";
}

<div class="category-chart">
    @if (Labels == null || Values == null || Values.Length == 0 || Labels.Length == 0)
    {
        <div class="no-data">@EmptyMessage</div>
    }
    else
    {
        var palette = new[] { "#4caf50", "#f44336", "#2196f3", "#ff9800", "#9c27b0", "#3f51b5", "#00bcd4", "#8bc34a" };
        double max = Values.Max();
        for (int i = 0; i < Labels.Length; i++)
        {
            var label = Labels[i];
            var val = Values.Length > i ? Values[i] : 0.0;
            var pct = max > 0 ? Math.Round((val / max) * 100, 2) : 0.0;
            var color = palette[i % palette.Length];
            <div class="category-row">
                <div class="cat-info">
                    <div class="label">@label</div>
                    <div class="amount">@string.Format(new CultureInfo("pt-BR"), "{0:C}", val)</div>
                </div>
                <div class="bar-bg">
                    <div class="bar" style="width:@pct%;background:@color"></div>
                </div>
            </div>
        }
    }
</div>
